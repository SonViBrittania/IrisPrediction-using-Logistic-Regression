from sklearn import datasets
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestClassifier
from sklearn.linear_model import LogisticRegression


iris = datasets.load_iris()
df = pd.DataFrame(iris.data, columns=iris.feature_names)
df["target"] = pd.Categorical.from_codes(iris.target, iris.target_names)
df[["sepal_1", "sepal_w", "petal_l", "petal_w"]] = df[["sepal length (cm)", "sepal width (cm)", "petal length (cm)", "petal width (cm)"]]
df = df.drop(columns = ["sepal length (cm)", "sepal width (cm)", "petal length (cm)", "petal width (cm)"])
X = df[["sepal_1", "sepal_w", "petal_l", "petal_w"]]
y = df['target']

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=41)
rfc = RandomForestClassifier(max_depth=5, min_samples_split=5, random_state=41)
rfc.fit(X_train, y_train)
y_pred = rfc.predict(X_test)

lrm = LogisticRegression(multi_class='multinomial', max_iter=200)
lrm.fit(X_train, y_train)

def predict():
    sepal_l = float(input("Enter the Sepal Length: "))
    sepal_w = float(input("Enter the Sepal Width: "))
    petal_l = float(input("Enter the Petal Length: "))
    petal_w = float(input("Enter the Petal Width: "))

    X = [[sepal_l, sepal_w, petal_l, petal_w]]
    X = pd.DataFrame(X, columns=["sepal_1", "sepal_w", "petal_l", "petal_w"])
    return f"{lrm.predict(X)[0]} is the predicted flower type"

print(predict())
